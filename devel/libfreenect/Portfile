# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0
PortGroup           cmake 1.0
PortGroup           github 1.0

github.setup        OpenKinect libfreenect 0.1.2 v
categories          devel graphics games
platforms           darwin
maintainers         gwmail.gwu.edu:egall openmaintainer
license             {apache GPL-2+}

description         ${name}, aka OpenKinect, is the core library for accessing the \
                    Microsoft Kinect USB camera

long_description    ${description}. It is the main part of the OpenKinect project.

homepage            http://www.openkinect.org/

checksums           rmd160  2687003673e95ca8cc7d27d9d1f155d389424ffe \
                    sha256  88cadbea8fb28838bd56a1ec86808325a8f531e93f2bba171e368137d6b1f6e9

depends_build-append \
                    port:pkgconfig
depends_lib-append  port:libtool \
                    port:libusb

configure.args-append \
                    -DBUILD_EXAMPLES=OFF \
                    -DBUILD_AS3_SERVER=OFF \
                    -DBUILD_CV=OFF \
                    -DBUILD_PYTHON=OFF

variant python25 conflicts python26 python27 {
    depends_build-append \
                    port:py25-distribute
    depends_lib-append \
                    path:lib/python2.5/site-packages/pyusb-0.4.3-py2.5.egg-info:py25-pyusb \
                    port:py25-cython \
                    port:py25-numpy
    configure.args-delete \
                    -DBUILD_PYTHON=OFF
    configure.args-append \
                    -DBUILD_PYTHON=ON
}

variant python26 conflicts python25 python27 {
    depends_build-append \
                    port:py26-distribute
    depends_lib-append \
                    path:share/doc/py26-pyusb/README:py26-pyusb \
                    port:py26-cython \
                    port:py26-numpy \
                    port:py26-matplotlib
    configure.args-delete \
                    -DBUILD_PYTHON=OFF
    configure.args-append \
                    -DBUILD_PYTHON=ON
}

variant python27 conflicts python25 python26 {
    depends_build-append \
                    port:py27-distribute
    depends_lib-append \
                    path:share/doc/py27-pyusb/README:py27-pyusb \
                    port:py27-numpy \
                    port:py27-cython \
                    port:py27-matplotlib
    configure.args-delete \
                    -DBUILD_PYTHON=OFF
    configure.args-append \
                    -DBUILD_PYTHON=ON
}

# Not sure how exactly I'm going to get this variant to work...
variant java {
    PortGroup       java 1.0
    depends_build-append \
                    bin:mvn:maven2
}

# This variant needs a port for rb-jeweler before it can actually work and do anything
variant ruby {
    depends_build-append \
                    bin:rake:rb-rake \
    depends_lib-append \
                    port:libffi
}

# This variant is commented out because I'm not sure how exactly to build it from the CLI yet...
# I can do it through the GUI in MonoDevelop though...
#variant csharp {
#}

variant opencv {
    depends_lib-append \
                    port:opencv
    configure.args-delete \
                    -DBUILD_CV=OFF
    configure.args-append \
                    -DBUILD_CV=ON
}

variant actionscript {
    depends_lib-append \
                    port:jpeg
    configure.args-delete \
                    -DBUILD_AS3_SERVER=OFF
    configure.args-append \
                    -DBUILD_AS3_SERVER=ON
}

variant docs {
    depends_build-append \
                    port:doxygen
    post-build {
        system -W ${worksrcpath}/doc "doxygen"
    }
}

variant examples {
    configure.args-delete \
                    -DBUILD_EXAMPLES=OFF
    configure.args-append \
                    -DBUILD_EXAMPLES=ON
}

default_variants    +examples
