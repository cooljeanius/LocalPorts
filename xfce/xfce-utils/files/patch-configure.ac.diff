--- configure.in	2010-05-21 12:56:26.000000000 -0400
+++ configure.ac	2013-10-02 15:48:52.000000000 -0400
@@ -1,96 +1,134 @@
-dnl
-dnl This file was autogenerated from "configure.in.in".
-dnl Edit that file instead!
-dnl
-
-dnl $Id$
-dnl
-dnl Copyright (c) 2002-2009
-dnl         The Xfce development team. All rights reserved.
-dnl
-dnl Written for Xfce by Olivier Fourdan <fourdan@xfce.org>, Jasper
-dnl Huijsmans <jasper@xfce.org>, Benedikt Meurer <benny@xfce.org>
-dnl and Xavier MAILLARD <zedek@fxgsproject.org>.
-dnl
-
-m4_define([xfce_utils_version_major], [4])
-m4_define([xfce_utils_version_minor], [6])
-m4_define([xfce_utils_version_micro], [2])
-m4_define([xfce_utils_version_nano],  []) dnl leave this empty to have no nano version
-m4_define([xfce_utils_version_build], [1d1ccd8])
-m4_define([xfce_utils_version_tag],   [])
-m4_define([xfce_utils_version], [xfce_utils_version_major().xfce_utils_version_minor().xfce_utils_version_micro()ifelse(xfce_utils_version_nano(), [], [], [.xfce_utils_version_nano()])ifelse(xfce_utils_version_tag(), [git], [xfce_utils_version_tag()-xfce_utils_version_build()], [xfce_utils_version_tag()])])
+dnl#                                               -*- Autoconf -*-
+dnl# Process this file with autoconf to produce a configure script.
 
-AC_INIT([xfce-utils], [xfce_utils_version], [xfce@xfce.org])
-AM_INIT_AUTOMAKE([dist-bzip2])
-
-AC_DEFINE_UNQUOTED([RELEASE_LABEL], ["Xfce 4.6"], [Optional release plain name])
-AC_SUBST(RELEASE_LABEL)
-
-AM_CONFIG_HEADER([config.h])
+dnl#
+dnl# This file was autogenerated from "configure.in.in".
+dnl# Edit that file instead!
+dnl#
+
+dnl# $Id$
+dnl#
+dnl# Copyright (c) 2002-2009
+dnl#         The Xfce development team. All rights reserved.
+dnl#
+dnl# Written for Xfce by Olivier Fourdan <fourdan@xfce.org>, Jasper
+dnl# Huijsmans <jasper@xfce.org>, Benedikt Meurer <benny@xfce.org>
+dnl# and Xavier MAILLARD <zedek@fxgsproject.org>.
+dnl#
+
+m4_define([xfce_utils_version_major],[4])
+m4_define([xfce_utils_version_minor],[6])
+m4_define([xfce_utils_version_micro],[2])
+m4_define([xfce_utils_version_nano],[]) dnl# leave this empty to have no nano version
+m4_define([xfce_utils_version_build],[1d1ccd8])
+m4_define([xfce_utils_version_tag],[])
+m4_define([xfce_utils_version],[xfce_utils_version_major().xfce_utils_version_minor().xfce_utils_version_micro()ifelse(xfce_utils_version_nano(),[],[],[.xfce_utils_version_nano()])ifelse(xfce_utils_version_tag(),[git],[xfce_utils_version_tag()-xfce_utils_version_build()],[xfce_utils_version_tag()])])
+
+AC_PREREQ([2.61])
+AC_INIT([xfce-utils],[xfce_utils_version],[xfce@xfce.org])
+
+AC_CANONICAL_TARGET
+AC_OBJEXT
+AC_EXEEXT
+
+AM_INIT_AUTOMAKE([1.8 dist-bzip2 foreign -Wall])
+
+AC_DEFINE_UNQUOTED([RELEASE_LABEL],["Xfce 4.6"],[Optional release plain name])
+AC_SUBST([RELEASE_LABEL])
+
+AC_CONFIG_SRCDIR([config.h.in])
+AC_CONFIG_HEADERS([config.h])
+AC_CONFIG_MACRO_DIR([m4])
 
 AM_MAINTAINER_MODE
 
-dnl Check for UNIX variants
-AC_AIX
-AC_ISC_POSIX
-AC_MINIX
-AM_CONDITIONAL([HAVE_CYGWIN], [test "`uname | grep \"CYGWIN\"`" != ""])
-
-dnl Check for basic programs
-AC_PROG_CC
+dnl# Check for UNIX variants
+AC_USE_SYSTEM_EXTENSIONS
+AC_SEARCH_LIBS([strerror],[cposix])
+AM_CONDITIONAL([HAVE_CYGWIN],[test "`uname | grep \"CYGWIN\"`" != ""])
+
+dnl# Check for basic programs
+if test "x$CC" = "x"; then
+	test -z "$CC"
+	AC_PROG_CC
+else
+	test ! -z "$CC" && export CC
+	AC_SUBST([CC])
+fi
+AC_DEFUN([AC_REQUIRE_PROG_CXX],[
+  AC_REQUIRE([AC_PROG_CXX])
+])
+AC_REQUIRE_PROG_CXX
 AC_PROG_INSTALL
-AC_PROG_LIBTOOL
-AC_PROG_INTLTOOL([0.31], [no-xml])
+AC_PROG_LN_S
+LT_INIT([win32-dll])
+IT_PROG_INTLTOOL([0.31],[no-xml])
+AC_DEFUN([AC_REQUIRE_PROG_RANLIB],[
+  if test "x$RANLIB" = "x"; then
+    test -z "$RANLIB"
+    AC_REQUIRE([AC_PROG_RANLIB])
+  else
+    test ! -z "$RANLIB" && export RANLIB
+    AC_SUBST([RANLIB])
+  fi
+])
+AC_REQUIRE_PROG_RANLIB
 
-dnl Check C Compiler Characteristics
+dnl# Check C Compiler Characteristics
+AC_C_BIGENDIAN
 AC_C_CONST
 AC_C_INLINE
+AC_C_PROTOTYPES
 
-dnl Check for standard header files
-AC_HEADER_STDC
-AC_CHECK_HEADERS([errno.h unistd.h string.h])
-AC_CHECK_FUNCS([daemon setsid])
+dnl# Check for standard header files
+AC_DEFUN([AC_REQUIRE_HEADER_STDC],[
+  AC_REQUIRE([AC_HEADER_STDC])
+])
+AC_REQUIRE_HEADER_STDC
+AC_CHECK_HEADERS([errno.h locale.h stdio.h])
 
-dnl Check for X11 installed
+# Checks for library functions.
+AC_FUNC_FORK
+AC_CHECK_FUNCS([daemon setsid strerror strstr])
+AC_CHECK_DECLS([daemon])
+
+dnl# Check for X11 installed
+AC_PATH_XTRA
 XDT_CHECK_LIBX11_REQUIRE
 
-dnl Check for default browser to use
+dnl# Check for default browser to use
 AC_MSG_CHECKING([what browser to use by default])
 AC_ARG_WITH([browser],
-AC_HELP_STRING([--with-browser=BROWSER], [What should be the default browser?]),
-  [], [with_browser=""])
+[AS_HELP_STRING([--with-browser=BROWSER],[What should be the default browser?])],
+  [],[with_browser=""])
 BROWSER_DEFAULT=$with_browser
 AC_SUBST([BROWSER_DEFAULT])
 AC_MSG_RESULT([$with_browser])
 
-dnl Check for default terminal to use
+dnl# Check for default terminal to use
 AC_MSG_CHECKING([what terminal to use by default])
 AC_ARG_WITH([terminal],
-AC_HELP_STRING([--with-terminal=TERMINAL], 
-	       [What should be the default terminal?]),
-	       [], [with_terminal=""])
+AS_HELP_STRING([--with-terminal=TERMINAL],[What should be the default terminal?]),
+	       [],[with_terminal=""])
 TERMINAL_DEFAULT=$with_terminal
 AC_SUBST([TERMINAL_DEFAULT])
 AC_MSG_RESULT([$with_terminal])
 
-
-dnl Check for default browser to use
+dnl# Check for default xsession-prefix to use
 AC_MSG_CHECKING([what xsession-prefix to use])
 AC_ARG_WITH([xsession-prefix],
-            AC_HELP_STRING([--with-xsession-prefix=XSESSION_PREFIX], [What should be the prefix for the xsession .desktop file?]),
-  [], [with_xsession_prefix="/usr"])
+            [AS_HELP_STRING([--with-xsession-prefix=XSESSION_PREFIX],[What should be the prefix for the xsession .desktop file?])],
+  [],[with_xsession_prefix="/usr"])
 XSESSION_PREFIX=$with_xsession_prefix
 AC_SUBST([XSESSION_PREFIX])
 AC_MSG_RESULT([$with_xsession_prefix])
 
-dnl the xfconf migration requires perl with XML::Parser
+dnl# the xfconf migration requires perl with XML::Parser
 AC_ARG_ENABLE([xfconf-migration],
-              [AC_HELP_STRING([--disable-xfconf-migration],
-                              [Don't require perl/XML::Parser for Xfconf settings migration @<:@default=required@:>@])],
-              [do_xfconf_migration=$enableval], [do_xfconf_migration=yes])
+              [AS_HELP_STRING([--disable-xfconf-migration],[Do NOT require perl/XML::Parser for Xfconf settings migration @<:@default=required@:>@])],
+              [do_xfconf_migration=$enableval],[do_xfconf_migration=yes])
 if test "x$do_xfconf_migration" = "xyes"; then
-    AC_PATH_PROGS([PERL], [perl5.8 perl5.6 perl5 perl])
+    AC_PATH_PROGS([PERL],[perl5.12 perl5.10 perl5.8 perl5 perl])
     if test -z "$PERL"; then
         AC_MSG_ERROR([perl not found; required for Xfconf migration. Pass --disable-xfconf-migration to ignore this.])
     fi
@@ -102,47 +140,47 @@
         AC_MSG_ERROR([perl module XML::Parser not found; required for Xfconf migration. Pass --disable-xfconf-migration to ignore this.])
     fi
 fi
-AM_CONDITIONAL([XFCONF_MIGRATION], [test "x$do_xfconf_migration" = "xyes"])
+AM_CONDITIONAL([XFCONF_MIGRATION],[test "x$do_xfconf_migration" = "xyes"])
 
-dnl Check for i18n support
-XDT_I18N([af am ar ast az be bg bn_IN ca cs da de dz el en_GB eo es_MX es et eu fa fi fr gl gu he hi hu hy id it ja ka kk ko ku lt lv mk mr ms nb nl nn pa pl pt_BR pt ro ru si sk sq sv ta tr ug uk ur_PK ur vi zh_CN zh_TW ])
+dnl# Check for i18n support
+XDT_I18N([af am ar ast az be bg bn_IN ca cs da de dz el en_GB eo es_MX es et eu fa fi fr gl gu he hi hu hy id it ja ka kk ko ku lt lv mk mr ms nb nl nn pa pl pt_BR pt ro ru si sk sq sv ta tr ug uk ur_PK ur vi zh_CN zh_TW])
 
-dnl Check for required packages
-XDT_CHECK_PACKAGE([GTK], [gtk+-2.0], [2.10.0])
-XDT_CHECK_PACKAGE([LIBXFCE4UTIL], [libxfce4util-1.0], [4.6.0])
-XDT_CHECK_PACKAGE([LIBXFCEGUI4], [libxfcegui4-1.0], [4.6.0])
-
-dnl check for dbus and libdbus-glib
-AM_CONDITIONAL([HAVE_DBUS], [test "x$DBUS_FOUND" = "xyes"])
-XDT_CHECK_OPTIONAL_PACKAGE([DBUS], [dbus-glib-1], 
-                           [0.33], [dbus], [D-BUS support])
+dnl# Check for required packages
+XDT_CHECK_PACKAGE([GTK],[gtk+-2.0],[2.10.0])
+XDT_CHECK_PACKAGE([LIBXFCE4UTIL],[libxfce4util-1.0],[4.6.0])
+XDT_CHECK_PACKAGE([LIBXFCEGUI4],[libxfcegui4-1.0],[4.6.0])
+
+dnl# check for dbus and libdbus-glib
+AM_CONDITIONAL([HAVE_DBUS],[test "x$DBUS_FOUND" = "xyes"])
+XDT_CHECK_OPTIONAL_PACKAGE([DBUS],[dbus-glib-1], 
+                           [0.33],[dbus],[D-BUS support])
 
-dnl check for location Xfce glade files were installed to
+dnl# check for location Xfce glade files were installed to
 XFCE_LIBGLADE_MODULE_PATH="`pkg-config --variable libglade_module_path libxfcegui4-1.0`"
 XFCE_GLADE_CATALOG_PATH="`pkg-config --variable glade_catalog_path libxfcegui4-1.0`"
 XFCE_GLADE_PIXMAP_PATH="`pkg-config --variable glade_pixmap_path libxfcegui4-1.0`"
 XFCE_GLADE_MODULE_PATH="`pkg-config --variable glade_module_path libxfcegui4-1.0`"
-AC_SUBST(XFCE_LIBGLADE_MODULE_PATH)
-AC_SUBST(XFCE_GLADE_CATALOG_PATH)
-AC_SUBST(XFCE_GLADE_PIXMAP_PATH)
-AC_SUBST(XFCE_GLADE_MODULE_PATH)
+AC_SUBST([XFCE_LIBGLADE_MODULE_PATH])
+AC_SUBST([XFCE_GLADE_CATALOG_PATH])
+AC_SUBST([XFCE_GLADE_PIXMAP_PATH])
+AC_SUBST([XFCE_GLADE_MODULE_PATH])
 
-dnl Check for debugging support
+dnl# Check for debugging support
 XDT_FEATURE_DEBUG
 
-dnl Check for vendor specific information
+dnl# Check for vendor specific information
 AC_MSG_CHECKING([for additional vendor info])
 AC_ARG_WITH([vendor-info],
-AC_HELP_STRING([--with-vendor-info=FILE], [Specify an additional file that should be displayed in the about dialog]),
-  [], [with_vendor_info=])
+[AS_HELP_STRING([--with-vendor-info=FILE],[Specify an additional file that should be displayed in the about dialog])],
+  [],[with_vendor_info=])
 if test x"$with_vendor_info" != x""; then
-  AC_DEFINE_UNQUOTED([VENDOR_INFO], ["$with_vendor_info"], [Additional vendor info])
+  AC_DEFINE_UNQUOTED([VENDOR_INFO],["$with_vendor_info"],[Additional vendor info])
   AC_MSG_RESULT([$with_vendor_info])
 else
   AC_MSG_RESULT([none])
 fi
 
-AC_OUTPUT([
+AC_CONFIG_FILES([
 xfce-utils.spec
 Makefile
 po/Makefile.in
@@ -164,4 +202,5 @@
 scripts/xinitrc.in
 xfce4-about/Makefile
 ])
+AC_OUTPUT
 
