--- tools/msibuild.c.bak	2013-09-30 10:20:52.000000000 -0400
+++ tools/msibuild.c	2013-09-30 10:39:49.000000000 -0400
@@ -18,15 +18,58 @@
  * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA
  */
 
-#include <config.h>
-#include <stdio.h>
-#include <stdlib.h>
-#include <string.h>
-#include <unistd.h>
-#include <sys/stat.h>
+#ifdef HAVE_CONFIG_H
+# include "config.h"
+#else
+# warning Not including header that should have been generated by autoheader
+#endif /* HAVE_CONFIG_H */
+#ifdef HAVE_STDIO_H
+# include <stdio.h>
+#else
+# warning msibuild.c expects <stdio.h> to be included.
+#endif /* HAVE_STDIO_H */
+#ifdef HAVE_STDLIB_H
+# include <stdlib.h>
+#else
+# warning msibuild.c expects <stdlib.h> to be included.
+#endif /* HAVE_STDLIB_H */
+#ifdef HAVE_STRING_H
+# include <string.h>
+#else
+# ifdef HAVE_STRINGS_H
+#  include <strings.h>
+# else
+extern char *strchr ();
+extern char *strrchr ();
+# endif /* HAVE_STRINGS_H */
+#endif /* HAVE_STRING_H */
+#ifdef HAVE_SYS_STAT_H
+# include <sys/stat.h>
+#else
+# warning msibuild.c expects <sys/types.h> to be included.
+#endif /* HAVE_SYS_TYPES_H */
 #include <libmsi.h>
-#include <limits.h>
-#include <uuid.h>
+#ifdef HAVE_LIMITS_H
+# include <limits.h>
+#else
+# warning msibuild.c expects <limits.h> to be included.
+#endif /* HAVE_LIMITS_H */
+#ifdef HAVE_UUID_H
+# include <uuid.h>
+# if defined(HAVE_UNISTD_H) && !defined(_UUID_T)
+#  include <unistd.h>
+# endif /* HAVE_UNISTD_H */
+#elif defined(HAVE_OSSP_UUID_H)
+# ifndef _UUID_T
+#  define _UUID_T
+# endif
+# include <ossp/uuid.h>
+# undef HAVE_UNISTD_H
+#elif defined(HAVE_UNISTD_H) && !defined(_UUID_T)
+# include <unistd.h>
+#else
+# warning Not including a uuid-related header
+#endif /* HAVE_UUID_H or HAVE_OSSP_UUID_H or HAVE_UNISTD_H */
 
 #include "sqldelim.h"
 
