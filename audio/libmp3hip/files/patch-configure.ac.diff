--- configure.in	2002-04-05 11:50:56.000000000 -0500
+++ configure.ac	2013-05-08 20:09:46.000000000 -0400
@@ -4,9 +4,14 @@
 dnl Initialization and Versioning
 dnl ------------------------------------------------
 
-AC_INIT(lib/hip.c)
-AM_INIT_AUTOMAKE(libmp3hip,0.1)
-AC_REVISION($Id: configure.in,v 1.3 2002/04/05 16:50:56 myers_carpenter Exp $)
+AC_PREREQ([2.69])
+AC_INIT([libmp3hip], [0.1.2.1])
+AC_CONFIG_SRCDIR([examples/hip_example.c])
+AC_CONFIG_HEADERS([config.h])
+AC_CONFIG_MACRO_DIR([m4])
+AM_INIT_AUTOMAKE([foreign])
+AM_MAINTAINER_MODE
+AC_REVISION([$Id: configure.in,v 1.3 2002/04/05 16:50:56 myers_carpenter Exp $])
 
 dnl Library versioning
 
@@ -38,8 +43,14 @@
 cflags_save="$CFLAGS"
 AC_PROG_CC
 AC_PROG_CPP
+AC_PROG_CXX
 CFLAGS="$cflags_save"
 
+AC_PROG_EGREP
+AC_PROG_INSTALL
+AC_PROG_LN_S
+AC_PROG_MAKE_SET
+AC_PROG_RANLIB
 AM_PROG_LIBTOOL
 
 dnl --------------------------------------------------
@@ -78,7 +89,6 @@
 	*86-*-linux*)
 		DEBUG="-g -Wall -W -D_REENTRANT -D__NO_MATH_INLINES -fsigned-char"
 		CFLAGS="-O20 -ffast-math -mno-ieee-fp -D_REENTRANT -fsigned-char"
-#              	PROFILE="-Wall -W -pg -g -O20 -ffast-math -D_REENTRANT -fsigned-char -fno-inline -static"
 		PROFILE="-Wall -W -pg -g -O20 -ffast-math -mno-ieee-fp -D_REENTRANT -fsigned-char -fno-inline"
 
 		# glibc < 2.1.3 has a serious FP bug in the math inline header
@@ -86,18 +96,18 @@
 		# clobber is missing in the mathinline header, thus indicating
 		# the buggy version
 
-		AC_EGREP_CPP(log10.*fldlg2.*fxch,[
+		AC_EGREP_CPP([log10.*fldlg2.*fxch],[
 				#define __LIBC_INTERNAL_MATH_INLINES 1
 			     	#define __OPTIMIZE__
 				#include <math.h>
-				],bad=maybe,bad=no)
+				],[bad=maybe],[bad=no])
 		if test ${bad} = "maybe" ;then
-		      AC_EGREP_CPP(log10.*fldlg2.*fxch.*st\([[0123456789]]*\),
+		      AC_EGREP_CPP([log10.*fldlg2.*fxch.*st\([[0123456789]]*\)],
 					[
 					#define __LIBC_INTERNAL_MATH_INLINES 1
 				     	#define __OPTIMIZE__
 					#include <math.h>
-					],bad=no,bad=yes)
+					],[bad=no],[bad=yes])
 		fi
  		if test ${bad} = "yes" ;then
  AC_MSG_WARN([                                                        ])
@@ -139,10 +149,10 @@
 dnl --------------------------------------------------
 dnl Check if we should build the python module
 dnl --------------------------------------------------
-AC_MSG_CHECKING(whether to build python module)
-AC_ARG_ENABLE(python,
+AC_MSG_CHECKING([whether to build python module])
+AC_ARG_ENABLE([python],
   [  --enable-python         Build python module.],
-  CONFIG_PYTHONMOD="${enableval}", CONFIG_PYTHONMOD="no")
+  [CONFIG_PYTHONMOD="${enableval}"], [CONFIG_PYTHONMOD="no"])
 
 case "${CONFIG_PYTHONMOD}" in
 yes)
@@ -152,7 +162,7 @@
 	BUILD_PYTHON_MOD="no"
 	;;
 *)
-	AC_MSG_ERROR(bad value »${CONFIG_PYTHONMOD}« for python option)
+	AC_MSG_ERROR([bad value »${CONFIG_PYTHONMOD}« for python option])
 	;;
 esac
 AC_SUBST(BUILD_PYTHON_MOD)
@@ -162,26 +172,30 @@
 dnl Check for headers
 dnl --------------------------------------------------
 
-AC_CHECK_HEADER(memory.h,CFLAGS="$CFLAGS -DUSE_MEMORY_H",:)
+AC_CHECK_HEADERS([fcntl.h stdlib.h string.h secure/_string.h])
+AC_CHECK_HEADER([memory.h],[CFLAGS="$CFLAGS -DUSE_MEMORY_H"],[:])
 
 dnl --------------------------------------------------
 dnl Check for typedefs, structures, etc
 dnl --------------------------------------------------
 
-dnl none
+AC_TYPE_INT64_T
+AC_TYPE_SIZE_T
 
 dnl --------------------------------------------------
 dnl Check for libraries
 dnl --------------------------------------------------
 
-AC_CHECK_LIB(m, cos, LIBS="-lm", LIBS="")
+AC_CHECK_LIB([m], [cos], [LIBS="-lm"], [LIBS=""])
 
 dnl --------------------------------------------------
 dnl Check for library functions
 dnl --------------------------------------------------
 
 AC_FUNC_ALLOCA
+AC_FUNC_MALLOC
 AC_FUNC_MEMCMP
+AC_CHECK_FUNCS([bcopy memcpy memset pow sqrt strchr strrchr])
 
 dnl --------------------------------------------------
 dnl Do substitutions
@@ -194,4 +208,5 @@
 AC_SUBST(PROFILE)
 AC_SUBST(pthread_lib)
 
-AC_OUTPUT(Makefile lib/Makefile doc/Makefile include/Makefile examples/Makefile debian/Makefile python/Makefile)
+AC_CONFIG_FILES([Makefile lib/Makefile doc/Makefile include/Makefile examples/Makefile debian/Makefile python/Makefile])
+AC_OUTPUT
